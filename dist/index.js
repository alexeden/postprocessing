!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three")):"function"==typeof define&&define.amd?define(["three"],t):"object"==typeof exports?exports.postprocessing=t(require("three")):e.postprocessing=t(e.three)}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new i.Scene,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i.OrthographicCamera(-1,1,1,-1,0,1);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.scene=n,this.camera=r,this.uniform=null,this.quad=null,this.needsSwap=!0,this.needsDepthTexture=!1,this.renderToScreen=!1,this.enabled=!0}var t,n,c;return t=e,(n=[{key:"getFullscreenMaterial",value:function(){return null!==this.quad?this.quad.material:null}},{key:"getFullscreenMaterials",value:function(){return null===this.quad?[]:Array.isArray(this.quad.material)?this.quad.material:[this.quad.material]}},{key:"getFullscreenMaterialsOfType",value:function(e){return this.getFullscreenMaterials().filter(function(t){return t instanceof e})}},{key:"setFullscreenMaterial",value:function(e){if(null!==this.quad)this.quad.material=e;else{var t=new i.Mesh(new i.PlaneBufferGeometry(2,2),e);t.frustumCulled=!1,null!==this.scene&&(this.scene.add(t),this.quad=t)}}},{key:"getDepthTexture",value:function(){return null}},{key:"setDepthTexture",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"setSize",value:function(e,t){}},{key:"initialize",value:function(e,t){}},{key:"dispose",value:function(){var e=this;this.getFullscreenMaterials().forEach(function(e){return e.dispose()}),Object.keys(this).map(function(t){return e[t]}).filter(function(e){return null!==e&&"object"===r(e)&&"function"==typeof e.dispose}).forEach(function(e){return e.dispose()})}}])&&o(t.prototype,n),c&&o(t,c),e}();t.Pass=c},function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);t.PassName=r.PassName},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(10));var r=n(41);t.CopyMaterial=r.CopyMaterial;var o=n(44);t.EffectMaterial=o.EffectMaterial},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(7)),r(n(9));var o=n(39);t.Effect=o.Effect},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);t.ClearMaskPass=r.ClearMaskPass;var o=n(6);t.ClearPass=o.ClearPass;var i=n(18);t.EffectPass=i.EffectPass;var c=n(49);t.MaskPass=c.MaskPass;var a=n(0);t.Pass=a.Pass;var u=n(50);t.RenderPass=u.RenderPass;var s=n(51);t.ShaderPass=s.ShaderPass},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=n(0),f=n(2),y=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=c(this,a(t).call(this,f.PassName.Clear));var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e}({clearAlpha:0,clearColor:null},n);return e.needsSwap=!1,e.clearColor=r.clearColor,e.clearAlpha=r.clearAlpha,e}var n,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,l.Pass),n=t,(r=[{key:"render",value:function(e,n){var r,o=this.clearColor;null!==o&&(t.color.copy(e.getClearColor()),r=e.getClearAlpha(),e.setClearColor(o,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?void 0:n),e.clear(),null!==o&&e.setClearColor(t.color,r)}}])&&i(n.prototype,r),s&&i(n,s),t}();y.color=new s.Color,t.ClearPass=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.BlendFunction=r.BlendFunction;var o=n(19);t.BlendMode=o.BlendMode},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SKIP=0]="SKIP",e[e.ADD=1]="ADD",e[e.ALPHA=2]="ALPHA",e[e.AVERAGE=3]="AVERAGE",e[e.COLOR_BURN=4]="COLOR_BURN",e[e.COLOR_DODGE=5]="COLOR_DODGE",e[e.DARKEN=6]="DARKEN",e[e.DIFFERENCE=7]="DIFFERENCE",e[e.EXCLUSION=8]="EXCLUSION",e[e.LIGHTEN=9]="LIGHTEN",e[e.MULTIPLY=10]="MULTIPLY",e[e.DIVIDE=11]="DIVIDE",e[e.NEGATION=12]="NEGATION",e[e.NORMAL=13]="NORMAL",e[e.OVERLAY=14]="OVERLAY",e[e.REFLECT=15]="REFLECT",e[e.SCREEN=16]="SCREEN",e[e.SOFT_LIGHT=17]="SOFT_LIGHT",e[e.SUBTRACT=18]="SUBTRACT"}(t.BlendFunction||(t.BlendFunction={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(38))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40);t.Section=r.Section},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findSubstrings=function(e,t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n[1]);return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prefixSubstrings=function(e,t,n){var r,o,i=!0,c=!1,a=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;r="$1"+e+l.charAt(0).toUpperCase()+l.slice(1),o=new RegExp("([^\\.])(\\b"+l+"\\b)","g");var f=!0,y=!1,p=void 0;try{for(var d,v=n.entries()[Symbol.iterator]();!(f=(d=v.next()).done);f=!0){var b=d.value;null!==b[1]&&n.set(b[0],b[1].replace(o,r))}}catch(e){y=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(y)throw p}}}}catch(e){c=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(c)throw a}}}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(14)),r(n(4)),r(n(3)),r(n(5))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);t.EffectComposer=r.EffectComposer},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),c=n(5),a=n(3),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.renderer=t,this.inputBuffer=null,this.outputBuffer=null,this.copyPass=new c.ShaderPass(new a.CopyMaterial),this.passes=[];var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){r(e,t,n[t])})}return e}({depthBuffer:!0,stencilBuffer:!1},n);null!==this.renderer&&(this.renderer.autoClear=!1,this.inputBuffer=this.createBuffer(o.depthBuffer,o.stencilBuffer),this.outputBuffer=this.inputBuffer.clone())}var t,n,u;return t=e,(n=[{key:"replaceRenderer",value:function(e){var t,n,r,o=this.renderer;return null!==o&&o!==e&&(this.renderer=e,this.renderer.autoClear=!1,t=o.domElement.parentNode,n=o.getSize(),r=e.getSize(),null!==t&&(t.removeChild(o.domElement),t.appendChild(e.domElement)),n.width===r.width&&n.height===r.height||this.setSize()),o}},{key:"getDepthTexture",value:function(e){var t,n,r=this.passes,o=null,i=!0;for(t=0;t<e;++t)(n=r[t]).needsSwap?i=!i:n instanceof c.RenderPass&&(o=(i?this.inputBuffer:this.outputBuffer).depthTexture);return o}},{key:"createDepthTexture",value:function(e,t){var n=new i.DepthTexture(e,t);this.inputBuffer.stencilBuffer&&(n.format=i.DepthStencilFormat,n.type=i.UnsignedInt248Type),this.inputBuffer.depthTexture=n,this.outputBuffer.depthTexture=n.clone()}},{key:"createBuffer",value:function(e,t){var n=this.renderer.getDrawingBufferSize(),r=this.renderer.context.getContextAttributes().alpha,o=new i.WebGLRenderTarget(n.width,n.height,{minFilter:i.LinearFilter,magFilter:i.LinearFilter,format:r?i.RGBAFormat:i.RGBFormat,depthBuffer:e,stencilBuffer:t});return o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}},{key:"addPass",value:function(e,t){var n=this.renderer.getDrawingBufferSize();e.setSize(n.width,n.height),e.initialize(this.renderer,this.renderer.context.getContextAttributes().alpha),void 0!==t?this.passes.splice(t,0,e):t=this.passes.push(e)-1,e.needsDepthTexture&&(null===this.inputBuffer.depthTexture&&this.createDepthTexture(n.width,n.height),e.setDepthTexture(this.getDepthTexture(t)))}},{key:"removePass",value:function(e){this.passes.splice(this.passes.indexOf(e),1)}},{key:"render",value:function(e){var t,n,r,o=this.inputBuffer,i=this.outputBuffer,a=!1,u=!0,s=!1,l=void 0;try{for(var f,y=this.passes[Symbol.iterator]();!(u=(f=y.next()).done);u=!0){var p=f.value;p.enabled&&(p.render(this.renderer,o,i,e,a),p.needsSwap&&(a&&(this.copyPass.renderToScreen=p.renderToScreen,t=this.renderer.context,(n=this.renderer.state).buffers.stencil.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,o,i),n.buffers.stencil.setFunc(t.EQUAL,1,4294967295)),r=o,o=i,i=r),p instanceof c.MaskPass?a=!0:p instanceof c.ClearMaskPass&&(a=!1))}}catch(e){s=!0,l=e}finally{try{u||null==y.return||y.return()}finally{if(s)throw l}}}},{key:"setSize",value:function(e,t){var n;void 0!==e&&void 0!==t||(e=(n=this.renderer.getSize()).width,t=n.height),this.renderer.setSize(e,t);var r=this.renderer.getDrawingBufferSize();this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);var o=!0,i=!1,c=void 0;try{for(var a,u=this.passes[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){a.value.setSize(r.width,r.height)}}catch(e){i=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}}},{key:"reset",value:function(){var e=this.createBuffer(this.inputBuffer.depthBuffer,this.inputBuffer.stencilBuffer);this.dispose(),this.inputBuffer=e,this.outputBuffer=e.clone(),this.copyPass=new c.ShaderPass(new a.CopyMaterial)}},{key:"dispose",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=this.passes[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.dispose()}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}this.passes=[],null!==this.inputBuffer&&(this.inputBuffer.dispose(),this.inputBuffer=null),null!==this.outputBuffer&&(this.outputBuffer.dispose(),this.outputBuffer=null),this.copyPass.dispose()}}])&&o(t.prototype,n),u&&o(t,u),e}();t.EffectComposer=u},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),s=n(0),l=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=i(this,c(t).call(this,u.PassName.ClearMask))).needsSwap=!1,e}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,s.Pass),n=t,(r=[{key:"render",value:function(e){e.state.buffers.stencil.setTest(!1)}}])&&o(n.prototype,r),l&&o(n,l),t}();t.ClearMaskPass=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Clear="clear",e.ClearMask="clearMask",e.Effect="effect",e.Mask="mask",e.Render="render",e.Shader="shader"}(t.PassName||(t.PassName={}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e,t,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(4),l=n(3),f=n(0),y=n(2),p=n(47),d=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,a(t).call(this,y.PassName.Effect))).mainCamera=e,n.skipRendering=!1,n.quantize=!1,n.uniforms=0,n.varyings=0,n.minTime=1,n.maxTime=1e3;for(var r=arguments.length,o=new Array(r>1?r-1:0),c=1;c<r;c++)o[c-1]=arguments[c];return n.effects=o.sort(function(e,t){return t.attributes-e.attributes}),n.setFullscreenMaterial(n.createMaterial()),n}var n,r,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,f.Pass),n=t,(r=[{key:"createMaterial",value:function(){var e,t=/\bblend\b/g,n=new Map([[l.Section.FRAGMENT_HEAD,""],[l.Section.FRAGMENT_MAIN_UV,""],[l.Section.FRAGMENT_MAIN_IMAGE,""],[l.Section.VERTEX_HEAD,""],[l.Section.VERTEX_MAIN_SUPPORT,""]]),r=new Map,o=new Map,i=new Map,c=new Set,a=0,u=0,f=0,y=!1,d=!1,v=!0,b=!1,h=void 0;try{for(var m,g=this.effects[Symbol.iterator]();!(v=(m=g.next()).done);v=!0){var x=m.value;if(x.blendMode.blendFunction!==s.BlendFunction.SKIP)if(0!=(f&s.EffectAttribute.CONVOLUTION)&&0!=(x.attributes&s.EffectAttribute.CONVOLUTION))console.error("Convolution effects cannot be merged",x);else if(f|=x.attributes,u+=(e=p.integrateEffect("e"+a++,x,n,r,o,i,f)).varyings.length,y=y||e.transformedUv,d=d||e.readDepth,null!==x.extensions){var E=!0,S=!1,_=void 0;try{for(var O,P=x.extensions[Symbol.iterator]();!(E=(O=P.next()).done);E=!0){var M=O.value;c.add(M)}}catch(e){S=!0,_=e}finally{try{E||null==P.return||P.return()}finally{if(S)throw _}}}}}catch(e){b=!0,h=e}finally{try{v||null==g.return||g.return()}finally{if(b)throw h}}var w=!0,T=!1,A=void 0;try{for(var R,N=r.values()[Symbol.iterator]();!(w=(R=N.next()).done);w=!0){var j=R.value;n.set(l.Section.FRAGMENT_HEAD,"".concat(n.get(l.Section.FRAGMENT_HEAD)).concat(j.getShaderCode().replace(t,"blend"+j.blendFunction),"\n"))}}catch(e){T=!0,A=e}finally{try{w||null==N.return||N.return()}finally{if(T)throw A}}0!=(f&s.EffectAttribute.DEPTH)&&(d&&n.set(l.Section.FRAGMENT_MAIN_IMAGE,"float depth = readDepth(UV);\n\n\t".concat(n.get(l.Section.FRAGMENT_MAIN_IMAGE))),this.needsDepthTexture=!0),y?(n.set(l.Section.FRAGMENT_MAIN_UV,"vec2 transformedUv = vUv;\n".concat(n.get(l.Section.FRAGMENT_MAIN_UV))),o.set("UV","transformedUv")):o.set("UV","vUv"),n.forEach(function(e,t,n){return n.set(t,e.trim())}),this.uniforms=i.size,this.varyings=u,this.skipRendering=0===a,this.needsSwap=!this.skipRendering;var F=new l.EffectMaterial(n,o,i,this.mainCamera,this.dithering);if(c.size>0){var C=!0,D=!1,B=void 0;try{for(var k,I=c[Symbol.iterator]();!(C=(k=I.next()).done);C=!0){var U=k.value;F.extensions[U]=!0}}catch(e){D=!0,B=e}finally{try{C||null==I.return||I.return()}finally{if(D)throw B}}}return F}},{key:"recompile",value:function(){var e=this,t=0,n=0,r=null,o=0;this.getFullscreenMaterials().filter(function(e){return e instanceof l.EffectMaterial}).forEach(function(i){var c=i.uniforms.resolution.value;t=c.x,n=c.y,r=i.uniforms.depthBuffer.value,o=i.depthPacking,i.dispose(),e.uniforms=0,e.varyings=0});var i=this.createMaterial();i.setSize(t,n),this.setFullscreenMaterial(i),this.setDepthTexture(r,o)}},{key:"getDepthTexture",value:function(){var e=this.getFullscreenMaterials();return e.length>0?e[0].uniforms.depthBuffer.value:null}},{key:"setDepthTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.getFullscreenMaterialsOfType(l.EffectMaterial).forEach(function(n){n.uniforms.depthBuffer.value=e,n.depthPacking=t,n.needsUpdate=!0});var n=!0,r=!1,o=void 0;try{for(var i,c=this.effects[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){i.value.setDepthTexture(e,t)}}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}this.needsDepthTexture=null===e}},{key:"render",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!0,c=!1,a=void 0;try{for(var u,s=this.effects[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){u.value.update(e,t,o)}}catch(e){c=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(c)throw a}}this.skipRendering&&!this.renderToScreen||this.getFullscreenMaterials().forEach(function(i){var c=i.uniforms.time.value+o;i.uniforms.inputBuffer.value=t.texture,i.uniforms.time.value=c<=r.maxTime?c:r.minTime,e.render(r.scene,r.camera,r.renderToScreen?void 0:n)})}},{key:"setSize",value:function(e,t){this.getFullscreenMaterials().forEach(function(n){"setSize"in n&&n.setSize(e,t)});var n=!0,r=!1,o=void 0;try{for(var i,c=this.effects[Symbol.iterator]();!(n=(i=c.next()).done);n=!0){i.value.setSize(e,t)}}catch(e){r=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}}},{key:"initialize",value:function(e,t){var n=e.capabilities,r=Math.min(n.maxFragmentUniforms,n.maxVertexUniforms);this.uniforms>r&&console.warn("The current rendering context doesn't support more than ".concat(r," uniforms, but ").concat(this.uniforms," were defined")),r=n.maxVaryings,this.varyings>r&&console.warn("The current rendering context doesn't support more than ".concat(r," varyings, but ").concat(this.varyings," were defined"));var o=!0,i=!1,c=void 0;try{for(var a,u=this.effects[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){a.value.initialize(e,t)}}catch(e){i=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw c}}}},{key:"dispose",value:function(){c(a(t.prototype),"dispose",this).call(this);var e=!0,n=!1,r=void 0;try{for(var o,i=this.effects[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){o.value.dispose()}}catch(e){n=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"dithering",get:function(){return this.quantize},set:function(e){this.quantize!==e&&(this.getFullscreenMaterials().forEach(function(t){t.dithering=e,t.needsUpdate=!0}),this.quantize=e)}}])&&o(n.prototype,r),d&&o(n,d),t}();t.EffectPass=d},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),c=n(8),a=o(n(20)),u=o(n(21)),s=o(n(22)),l=o(n(23)),f=o(n(24)),y=o(n(25)),p=o(n(26)),d=o(n(27)),v=o(n(28)),b=o(n(29)),h=o(n(30)),m=o(n(31)),g=o(n(32)),x=o(n(33)),E=o(n(34)),S=o(n(35)),_=o(n(36)),O=o(n(37)),P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.blendFunction=t,this.opacity=new i.Uniform(n)}var t,n,o;return t=e,(n=[{key:"getShaderCode",value:function(){switch(this.blendFunction){case c.BlendFunction.SKIP:return null;case c.BlendFunction.ADD:return a.default;case c.BlendFunction.ALPHA:return u.default;case c.BlendFunction.AVERAGE:return s.default;case c.BlendFunction.COLOR_BURN:return l.default;case c.BlendFunction.COLOR_DODGE:return f.default;case c.BlendFunction.DARKEN:return y.default;case c.BlendFunction.DIFFERENCE:return p.default;case c.BlendFunction.EXCLUSION:return d.default;case c.BlendFunction.LIGHTEN:return v.default;case c.BlendFunction.MULTIPLY:return b.default;case c.BlendFunction.DIVIDE:return h.default;case c.BlendFunction.NEGATION:return m.default;case c.BlendFunction.NORMAL:return g.default;case c.BlendFunction.OVERLAY:return x.default;case c.BlendFunction.REFLECT:return E.default;case c.BlendFunction.SCREEN:return S.default;case c.BlendFunction.SOFT_LIGHT:return _.default;case c.BlendFunction.SUBTRACT:return O.default}}}])&&r(t.prototype,n),o&&r(t,o),e}();t.BlendMode=P},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn min(x + y, 1.0) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn y * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, y.a), x.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn (x + y) * 0.5 * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (y == 0.0) ? y : max(1.0 - (1.0 - x) / y, 0.0);\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (y == 1.0) ? y : min(x / (1.0 - y), 1.0);\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn min(x, y) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn abs(x - y) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn (x + y - 2.0 * x * y) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn max(x, y) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn x * y * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (y > 0.0) ? min(x / y, 1.0) : 1.0;\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn (1.0 - abs(1.0 - x - y)) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn y * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (x < 0.5) ? (2.0 * x * y) : (1.0 - 2.0 * (1.0 - x) * (1.0 - y));\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (y == 1.0) ? y : min(x * x / (1.0 - y), 1.0);\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn (1.0 - (1.0 - x) * (1.0 - y)) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="float blend(const in float x, const in float y) {\n\n\treturn (y < 0.5) ?\n\t\t(2.0 * x * y + x * x * (1.0 - 2.0 * y)) :\n\t\t(sqrt(x) * (2.0 * y - 1.0) + 2.0 * x * (1.0 - y));\n\n}\n\nvec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\tvec3 z = vec3(blend(x.r, y.r), blend(x.g, y.g), blend(x.b, y.b));\n\n\treturn z * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t){e.exports="vec3 blend(const in vec3 x, const in vec3 y, const in float opacity) {\n\n\treturn max(x + y - 1.0, 0.0) * opacity + x * (1.0 - opacity);\n\n}\n\nvec4 blend(const in vec4 x, const in vec4 y, const in float opacity) {\n\n\treturn vec4(blend(x.rgb, y.rgb, opacity), y.a);\n\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Glitch="GlitchEffect"}(t.EffectName||(t.EffectName={})),function(e){e[e.NONE=0]="NONE",e[e.DEPTH=1]="DEPTH",e[e.CONVOLUTION=2]="CONVOLUTION"}(t.EffectAttribute||(t.EffectAttribute={})),function(e){e.DERIVATIVES="derivatives",e.FRAG_DEPTH="fragDepth",e.DRAW_BUFFERS="drawBuffers",e.SHADER_TEXTURE_LOD="shaderTextureLOD"}(t.WebGLExtension||(t.WebGLExtension={}))},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(7),c=n(9),a=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.fragmentShader=n,this.vertexShader=null;var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){r(e,t,n[t])})}return e}({attributes:c.EffectAttribute.NONE,blendFunction:i.BlendFunction.SCREEN,defines:new Map,uniforms:new Map,extensions:new Set,vertexShader:null},o);this.attributes=a.attributes,this.vertexShader=a.vertexShader,this.defines=a.defines,this.uniforms=a.uniforms,this.extensions=a.extensions,this.blendMode=new i.BlendMode(a.blendFunction)}var t,n,a;return t=e,(n=[{key:"setDepthTexture",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"update",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},{key:"setSize",value:function(e,t){}},{key:"initialize",value:function(e,t){}},{key:"dispose",value:function(){for(var e=Object.keys(this),t=0;t<e.length;t++){var n=e[t];null!==this[n]&&"function"==typeof this[n].dispose&&(this[n].dispose(),this[n]=null)}}}])&&o(t.prototype,n),a&&o(t,a),e}();t.Effect=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.FRAGMENT_HEAD="FRAGMENT_HEAD",e.FRAGMENT_MAIN_UV="FRAGMENT_MAIN_UV",e.FRAGMENT_MAIN_IMAGE="FRAGMENT_MAIN_IMAGE",e.VERTEX_HEAD="VERTEX_HEAD",e.VERTEX_MAIN_SUPPORT="VERTEX_MAIN_SUPPORT"}(t.Section||(t.Section={}))},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),s=a(n(42)),l=a(n(43)),f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,i(t).call(this,{uniforms:{inputBuffer:new u.Uniform(null),opacity:new u.Uniform(1)},fragmentShader:s.default,vertexShader:l.default,depthWrite:!1,depthTest:!1}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,u.ShaderMaterial),t}();t.CopyMaterial=f},function(e,t){e.exports="uniform sampler2D inputBuffer;\nuniform float opacity;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texel = texture2D(inputBuffer, vUv);\n\tgl_FragColor = opacity * texel;\n\n}\n"},function(e,t){e.exports="varying vec2 vUv;\n\nvoid main() {\n\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}\n"},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1),l=n(10),f=u(n(45)),y=u(n(46)),p=function(e){function t(e,n,r){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=i(this,c(t).call(this,{defines:{DEPTH_PACKING:"0"},uniforms:{inputBuffer:new s.Uniform(null),depthBuffer:new s.Uniform(null),resolution:new s.Uniform(new s.Vector2),texelSize:new s.Uniform(new s.Vector2),cameraNear:new s.Uniform(.3),cameraFar:new s.Uniform(1e3),aspect:new s.Uniform(1),time:new s.Uniform(0)},fragmentShader:f.default.replace(l.Section.FRAGMENT_HEAD,e.get(l.Section.FRAGMENT_HEAD)).replace(l.Section.FRAGMENT_MAIN_UV,e.get(l.Section.FRAGMENT_MAIN_UV)).replace(l.Section.FRAGMENT_MAIN_IMAGE,e.get(l.Section.FRAGMENT_MAIN_IMAGE)),vertexShader:y.default.replace(l.Section.VERTEX_HEAD,e.get(l.Section.VERTEX_HEAD)).replace(l.Section.VERTEX_MAIN_SUPPORT,e.get(l.Section.VERTEX_MAIN_SUPPORT)),dithering:u,depthWrite:!1,depthTest:!1})),null!==n){var p=!0,d=!1,v=void 0;try{for(var b,h=n.entries()[Symbol.iterator]();!(p=(b=h.next()).done);p=!0){var m=b.value;o.defines[m[0]]=m[1]}}catch(e){d=!0,v=e}finally{try{p||null==h.return||h.return()}finally{if(d)throw v}}}if(null!==r){var g=!0,x=!1,E=void 0;try{for(var S,_=r.entries()[Symbol.iterator]();!(g=(S=_.next()).done);g=!0){var O=S.value;o.uniforms[O[0]]=O[1]}}catch(e){x=!0,E=e}finally{try{g||null==_.return||_.return()}finally{if(x)throw E}}}return o.adoptCameraSettings(a),o}var n,r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,s.ShaderMaterial),n=t,(r=[{key:"setSize",value:function(e,t){e=Math.max(e,1),t=Math.max(t,1),this.uniforms.resolution.value.set(e,t),this.uniforms.texelSize.value.set(1/e,1/t),this.uniforms.aspect.value=e/t}},{key:"adoptCameraSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&(e instanceof s.PerspectiveCamera?(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,this.defines.PERSPECTIVE_CAMERA="1"):delete this.defines.PERSPECTIVE_CAMERA)}},{key:"depthPacking",get:function(){return Number.parseInt(this.defines.DEPTH_PACKING,10)},set:function(e){this.defines.DEPTH_PACKING=e.toFixed(0)}}])&&o(n.prototype,r),u&&o(n,u),t}();t.EffectMaterial=p},function(e,t){e.exports="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n\nuniform sampler2D inputBuffer;\nuniform sampler2D depthBuffer;\n\nuniform vec2 resolution;\nuniform vec2 texelSize;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform float aspect;\nuniform float time;\n\nvarying vec2 vUv;\n\nfloat readDepth(const in vec2 uv) {\n\n\t#if DEPTH_PACKING == 3201\n\n\t\treturn unpackRGBAToDepth(texture2D(depthBuffer, uv));\n\n\t#else\n\n\t\treturn texture2D(depthBuffer, uv).r;\n\n\t#endif\n\n}\n\nFRAGMENT_HEAD\n\nvoid main() {\n\n\tFRAGMENT_MAIN_UV\n\n\tvec4 color0 = texture2D(inputBuffer, UV);\n\tvec4 color1 = vec4(0.0);\n\n\tFRAGMENT_MAIN_IMAGE\n\n\tgl_FragColor = color0;\n\n\t#include <dithering_fragment>\n\n}\n"},function(e,t){e.exports="uniform vec2 resolution;\nuniform vec2 texelSize;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform float aspect;\nuniform float time;\n\nvarying vec2 vUv;\n\nVERTEX_HEAD\n\nvoid main() {\n\n\tvUv = uv;\n\n\tVERTEX_MAIN_SUPPORT\n\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\n}\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.findSubstrings=r.findSubstrings;var o=n(48);t.integrateEffect=o.integrateEffect;var i=n(12);t.prefixSubstrings=i.prefixSubstrings},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(3),i=n(11),c=n(12);t.integrateEffect=function(e,t,n,a,u,s,l){var f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,y=t.blendMode,p=new Map([["fragment",t.fragmentShader],["vertex",t.vertexShader]]),d=t.fragmentShader.includes("mainImage"),v=t.fragmentShader.includes("mainUv"),b=[],h=[],m=!1,g=!1;if(void 0===p.get("fragment"))console.error("Missing fragment shader",t);else if(v&&0!=(l&r.EffectAttribute.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(d||v){if(v&&(n.set(o.Section.FRAGMENT_MAIN_UV,n.get(o.Section.FRAGMENT_MAIN_UV)+"\t"+e+"MainUv(UV);\n"),m=!0),null!==p.get("vertex")&&p.get("vertex").indexOf("mainSupport")>=0&&(n.set(o.Section.VERTEX_MAIN_SUPPORT,n.get(o.Section.VERTEX_MAIN_SUPPORT)+"\t"+e+"MainSupport();\n"),b=b.concat(i.findSubstrings(/(?:varying\s+\w+\s+(\w*))/g,p.get("vertex"))),h=h.concat(b).concat(i.findSubstrings(f,p.get("vertex")))),h=h.concat(i.findSubstrings(f,p.get("fragment"))).concat(Array.from(t.uniforms.keys())).concat(Array.from(t.defines.keys())),t.uniforms.forEach(function(t,n){return s.set(e+n.charAt(0).toUpperCase()+n.slice(1),t)}),t.defines.forEach(function(t,n){return u.set(e+n.charAt(0).toUpperCase()+n.slice(1),t)}),c.prefixSubstrings(e,h,u),c.prefixSubstrings(e,h,p),a.set(y.blendFunction,y),d){var x=e+"MainImage(color0, UV, ";0!=(l&r.EffectAttribute.DEPTH)&&p.get("fragment").indexOf("depth")>=0&&(x+="depth, ",g=!0),x+="color1);\n\t";var E=e+"BlendOpacity";s.set(E,y.opacity),x+="color0 = blend"+y.blendFunction+"(color0, color1, "+E+");\n\n\t",n.set(o.Section.FRAGMENT_MAIN_IMAGE,n.get(o.Section.FRAGMENT_MAIN_IMAGE)+x),n.set(o.Section.FRAGMENT_HEAD,n.get(o.Section.FRAGMENT_HEAD)+"uniform float "+E+";\n\n")}n.set(o.Section.FRAGMENT_HEAD,n.get(o.Section.FRAGMENT_HEAD)+p.get("fragment")+"\n"),null!==p.get("vertex")&&n.set(o.Section.VERTEX_HEAD,n.get(o.Section.VERTEX_HEAD)+p.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:b,transformedUv:m,readDepth:g}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),s=n(0),l=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=i(this,c(t).call(this,u.PassName.Mask,e,n))).inverse=!1,r.clearStencil=!0,r.needsSwap=!1,r}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,s.Pass),n=t,(r=[{key:"render",value:function(e,t,n){var r=e.context,o=e.state,i=this.scene,c=this.camera,a=this.inverse?0:1,u=1-a;o.buffers.color.setMask(0),o.buffers.depth.setMask(0),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.buffers.stencil.setFunc(r.ALWAYS,a,4294967295),o.buffers.stencil.setClear(u),this.clearStencil&&(this.renderToScreen?(e.setRenderTarget(),e.clearStencil()):(e.setRenderTarget(t),e.clearStencil(),e.setRenderTarget(n),e.clearStencil())),this.renderToScreen?e.render(i,c):(e.render(i,c,t),e.render(i,c,n)),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setFunc(r.EQUAL,1,4294967295),o.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP)}}])&&o(n.prototype,r),l&&o(n,l),t}();t.MaskPass=l},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),l=n(0),f=n(2),y=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=c(this,a(t).call(this,f.PassName.Render,e,n))).scene=e,r.camera=n,r.overrideMaterial=null;var u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e}({overrideMaterial:null,clearAlpha:1,clearDepth:!1,clear:!0},i);return r.needsSwap=!1,r.clearPass=new s.ClearPass(u),r.overrideMaterial=u.overrideMaterial,r.clearDepth=u.clearDepth,r.clear=u.clear,r}var n,r,y;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,l.Pass),n=t,(r=[{key:"render",value:function(e,t){var n=this.scene,r=this.renderToScreen?void 0:t,o=n.overrideMaterial;this.clear?(this.clearPass.renderToScreen=this.renderToScreen,this.clearPass.render(e,t)):this.clearDepth&&(e.setRenderTarget(r),e.clearDepth()),n.overrideMaterial=this.overrideMaterial,e.render(n,this.camera,r),n.overrideMaterial=o}}])&&i(n.prototype,r),y&&i(n,y),t}();t.RenderPass=y},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),s=n(0),l=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,c(t).call(this,u.PassName.Shader))).setFullscreenMaterial(e),n.uniform=null,n.setInput(r),n}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(t,s.Pass),n=t,(r=[{key:"setInput",value:function(e){var t=this,n=this.getFullscreenMaterials();this.uniform=null,n.forEach(function(n){var r=n.uniforms;void 0!==r[e]&&(t.uniform=r[e])})}},{key:"render",value:function(e,t,n){null!==this.uniform&&(this.uniform.value=t.texture),e.render(this.scene,this.camera,this.renderToScreen?void 0:n)}}])&&o(n.prototype,r),l&&o(n,l),t}();t.ShaderPass=l}])});
//# sourceMappingURL=index.js.map